!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/forms"],t):t(e["ng-selectize"]=e["ng-selectize"]||{},e.ng.core,e.ng.forms)}(this,function(e,t,o){"use strict";var i=require("lodash.isequal"),n=require("lodash.clonedeep"),s=require("lodash.find"),l=require("lodash.differencewith"),r={provide:o.NG_VALUE_ACCESSOR,useExisting:t.forwardRef(function(){return a}),multi:!0},a=function(){function e(){this.onBlur=new t.EventEmitter(!1),this.onTouchedCallback=function(){},this.onChangeCallback=function(){}}return e.prototype.ngOnInit=function(){this.reset()},e.prototype.reset=function(){this.selectize=$(this.selectizeInput.nativeElement).selectize(this.config)[0].selectize,this.selectize.on("change",this.onSelectizeValueChange.bind(this)),this.selectize.on("option_add",this.onSelectizeOptionAdd.bind(this)),this.selectize.on("blur",this.onBlurEvent.bind(this)),this.onSelectizeOptionsChange(),this.onSelectizeOptionGroupChange(),this.placeholder&&this.placeholder.length>0&&this.updatePlaceholder(),this._oldOptions=n(this.options),this._oldOptionGroups=n(this.optionGroups)},e.prototype.ngOnChanges=function(e){this.selectize&&((e.hasOwnProperty("placeholder")||e.hasOwnProperty("hasOptionsPlaceholder")||e.hasOwnProperty("noOptionsPlaceholder"))&&this.updatePlaceholder(),e.hasOwnProperty("enabled")&&this.onEnabledStatusChange())},e.prototype.ngDoCheck=function(){i(this._oldOptions,this.options)||(this.onSelectizeOptionsChange(),this._oldOptions=n(this.options)),i(this._oldOptionGroups,this.optionGroups)||(this.onSelectizeOptionGroupChange(),this._oldOptionGroups=n(this.optionGroups)),this.evalHasError()},e.prototype.onBlurEvent=function(){this.formControl&&this.formControl.markAsTouched(),this.onBlur.emit(),this.evalHasError()},e.prototype.onSelectizeOptionAdd=function(e){if(this.value){var t="string"==typeof this.value?[this.value]:this.value;s(t,function(t){return t===e})&&this.selectize.addItem(e,!0)}},e.prototype.evalHasError=function(){this.formControl&&this.formControl.touched&&this.formControl.invalid?$(this.selectize.$control).parent().addClass(this.errorClass||"has-error"):$(this.selectize.$control).parent().removeClass(this.errorClass||"has-error")},e.prototype.updatePlaceholder=function(){this.selectize.settings.placeholder=this.getPlaceholder(),this.selectize.updatePlaceholder(),this.selectize.showInput()},e.prototype.onEnabledStatusChange=function(){this.enabled?this.selectize.enable():this.selectize.disable()},e.prototype.onSelectizeOptionsChange=function(){var e=this,t=l(this._oldOptions,this.options,function(t,o){return t[e.selectize.settings.valueField]===o[e.selectize.settings.valueField]&&t[e.selectize.settings.labelField]===o[e.selectize.settings.labelField]}),o=l(this.options,this._oldOptions,function(t,o){return t[e.selectize.settings.valueField]===o[e.selectize.settings.valueField]&&t[e.selectize.settings.labelField]===o[e.selectize.settings.labelField]});t&&t.length>0&&t.forEach(function(t){e.selectize.removeOption(t[e.selectize.settings.valueField])}),o&&o.length>0&&o.forEach(function(t){e.selectize.addOption(n(t))}),this.updatePlaceholder()},e.prototype.onSelectizeOptionGroupChange=function(){var e=this;null!=this.optionGroups&&this.optionGroups.length>0&&this.optionGroups.forEach(function(t){e.selectize.addOptionGroup(t.id,t)})},e.prototype.onSelectizeValueChange=function(e){this.value=this.selectize.getValue()},e.prototype.getPlaceholder=function(){var e;return e=null!=this.options&&this.options.length>0&&null!=this.hasOptionsPlaceholder&&this.hasOptionsPlaceholder.length>0?this.hasOptionsPlaceholder:(null==this.options||0==this.options.length)&&null!=this.noOptionsPlaceholder&&this.noOptionsPlaceholder.length>0?this.noOptionsPlaceholder:this.placeholder},e.prototype.writeValue=function(e){e!==this._value&&(this._value=e),this.selectize.setValue(this._value)},e.prototype.registerOnChange=function(e){this.onChangeCallback=e},e.prototype.registerOnTouched=function(e){this.onTouchedCallback=e},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value!==e&&setTimeout(function(){t._value=n(e),t.onChangeCallback(t._value)})},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"ng-selectize",template:"<select #selectizeInput></select>",providers:[r]}]}],e.ctorParameters=function(){return[]},e.propDecorators={config:[{type:t.Input,args:["config"]}],options:[{type:t.Input,args:["options"]}],optionGroups:[{type:t.Input,args:["optionGroups"]}],placeholder:[{type:t.Input,args:["placeholder"]}],hasOptionsPlaceholder:[{type:t.Input,args:["hasOptionsPlaceholder"]}],noOptionsPlaceholder:[{type:t.Input,args:["noOptionsPlaceholder"]}],enabled:[{type:t.Input,args:["enabled"]}],_value:[{type:t.Input,args:["ngModel"]}],formControl:[{type:t.Input}],errorClass:[{type:t.Input}],onBlur:[{type:t.Output}],selectizeInput:[{type:t.ViewChild,args:["selectizeInput"]}]},e}(),h=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{declarations:[a],exports:[a]}]}],e.ctorParameters=function(){return[]},e}();e.NgSelectizeModule=h,e.NgSelectizeComponent=a,Object.defineProperty(e,"__esModule",{value:!0})});